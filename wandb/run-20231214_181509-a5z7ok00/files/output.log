Vocab size : 53
---------------------Starting training---------------------
















  0%|▍                                                                                                                                                                         | 97/37328 [00:56<3:19:42,  3.11it/s]
  0%|▍                                                                                                                                                                        | 101/37328 [00:57<3:19:41,  3.11it/s]










100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:20<00:00,  2.48it/s]
[TEST EPOCH 0] Accuracy : 66.94140625% Test Loss : 1.1565189743041993 Best Loss : 1.1565189743041993
{hugo, quentin, louis}














  1%|▉                                                                                                                                                                        | 199/37328 [02:26<2:49:20,  3.65it/s]
  1%|▉                                                                                                                                                                        | 201/37328 [02:26<2:49:28,  3.65it/s]









 96%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████       | 48/50 [00:19<00:00,  2.48it/s]

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:20<00:00,  2.48it/s]
{hugo, quentin, louis}














  1%|█▎                                                                                                                                                                       | 296/37328 [03:16<2:49:10,  3.65it/s]
  1%|█▎                                                                                                                                                                       | 301/37328 [03:18<2:49:01,  3.65it/s]









 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                 | 45/50 [00:18<00:02,  2.47it/s]

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:20<00:00,  2.48it/s]
{hugo, quentin, louis}













  1%|█▊                                                                                                                                                                       | 396/37328 [04:06<2:49:07,  3.64it/s]
  1%|█▊                                                                                                                                                                       | 401/37328 [04:08<2:48:54,  3.64it/s]









 92%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 46/50 [00:18<00:01,  2.47it/s]

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:20<00:00,  2.47it/s]
{hugo, quentin, louis}














  1%|██▎                                                                                                                                                                      | 497/37328 [04:57<2:48:12,  3.65it/s]
  1%|██▎                                                                                                                                                                      | 501/37328 [04:58<2:48:18,  3.65it/s]









 92%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 46/50 [00:18<00:01,  2.47it/s]

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:20<00:00,  2.47it/s]
{hugo, quentin, louis}













  2%|██▋                                                                                                                                                                      | 595/37328 [05:47<2:48:02,  3.64it/s]
  2%|██▋                                                                                                                                                                      | 601/37328 [05:48<2:48:02,  3.64it/s]









 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                 | 45/50 [00:18<00:02,  2.47it/s]

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:20<00:00,  2.47it/s]
{hugo, quentin, louis}













  2%|███▏                                                                                                                                                                     | 695/37328 [06:37<2:47:23,  3.65it/s]
  2%|███▏                                                                                                                                                                     | 701/37328 [06:39<2:47:33,  3.64it/s]










100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:20<00:00,  2.47it/s]
[TEST EPOCH 0] Accuracy : 69.314453125% Test Loss : 1.028936903476715 Best Loss : 1.028936903476715
{hugo, quentin, louis}













  2%|███▌                                                                                                                                                                     | 796/37328 [07:27<2:47:03,  3.64it/s]
  2%|███▋                                                                                                                                                                     | 801/37328 [07:29<2:46:45,  3.65it/s]









 94%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌          | 47/50 [00:19<00:01,  2.47it/s]

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:20<00:00,  2.47it/s]
{hugo, quentin, louis}














  2%|████                                                                                                                                                                     | 898/37328 [08:18<2:46:10,  3.65it/s]
  2%|████                                                                                                                                                                     | 901/37328 [08:19<2:46:20,  3.65it/s]









 94%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌          | 47/50 [00:18<00:01,  2.48it/s]

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:20<00:00,  2.48it/s]
{hugo, quentin, louis}














  3%|████▌                                                                                                                                                                   | 1000/37328 [09:08<2:46:27,  3.64it/s]
  3%|████▌                                                                                                                                                                   | 1001/37328 [09:08<2:46:19,  3.64it/s]









 96%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████       | 48/50 [00:19<00:00,  2.48it/s]

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:20<00:00,  2.48it/s]
{hugo, quentin, louis}














  3%|████▉                                                                                                                                                                   | 1100/37328 [09:58<2:46:34,  3.62it/s]
  3%|████▉                                                                                                                                                                   | 1101/37328 [09:59<2:46:17,  3.63it/s]









 94%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌          | 47/50 [00:19<00:01,  2.47it/s]

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:20<00:00,  2.46it/s]
{hugo, quentin, louis}














  3%|█████▍                                                                                                                                                                  | 1197/37328 [10:48<2:50:01,  3.54it/s]
  3%|█████▍                                                                                                                                                                  | 1201/37328 [10:49<2:52:07,  3.50it/s]









 92%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 46/50 [00:18<00:01,  2.48it/s]


  3%|█████▍                                                                                                                                                                 | 1202/37328 [11:13<71:42:44,  7.15s/it]
{hugo, quentin, louis}













  3%|█████▊                                                                                                                                                                  | 1296/37328 [11:38<2:44:19,  3.65it/s]
  3%|█████▊                                                                                                                                                                  | 1301/37328 [11:40<2:44:13,  3.66it/s]










100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:20<00:00,  2.46it/s]

  3%|█████▊                                                                                                                                                                 | 1302/37328 [12:03<70:33:20,  7.05s/it]
{hugo, quentin, louis}











  4%|██████▏                                                                                                                                                                 | 1388/37328 [12:26<2:45:58,  3.61it/s]Exception ignored in: <function _MultiProcessingDataLoaderIter.__del__ at 0x165fc5e50>
Traceback (most recent call last):
  File "/Users/hugo/Desktop/Projects/conditionned_theatre_play_generation/.env/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1478, in __del__
    self._shutdown_workers()
  File "/Users/hugo/Desktop/Projects/conditionned_theatre_play_generation/.env/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1442, in _shutdown_workers
    w.join(timeout=_utils.MP_STATUS_CHECK_INTERVAL)
  File "/Users/hugo/.pyenv/versions/3.8.18/lib/python3.8/multiprocessing/process.py", line 149, in join
    res = self._popen.wait(timeout)
  File "/Users/hugo/.pyenv/versions/3.8.18/lib/python3.8/multiprocessing/popen_fork.py", line 44, in wait
    if not wait([self.sentinel], timeout):
  File "/Users/hugo/.pyenv/versions/3.8.18/lib/python3.8/multiprocessing/connection.py", line 931, in wait
    ready = selector.select(timeout)
  File "/Users/hugo/.pyenv/versions/3.8.18/lib/python3.8/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt:
  4%|██████▏                                                                                                                                                                 | 1388/37328 [12:27<5:22:24,  1.86it/s]
Traceback (most recent call last):
  File "train.py", line 241, in <module>
    step(model, optimizer, scheduler, train_loader, test_dataset, device, epoch, path, best_loss = 1000)
  File "train.py", line 40, in step
    logits = model(context)
  File "/Users/hugo/Desktop/Projects/conditionned_theatre_play_generation/.env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/hugo/Desktop/Projects/conditionned_theatre_play_generation/.env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/hugo/Desktop/Projects/conditionned_theatre_play_generation/model_V2.py", line 184, in forward
    out = self.blocks(out)
  File "/Users/hugo/Desktop/Projects/conditionned_theatre_play_generation/.env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/hugo/Desktop/Projects/conditionned_theatre_play_generation/.env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/hugo/Desktop/Projects/conditionned_theatre_play_generation/.env/lib/python3.8/site-packages/torch/nn/modules/container.py", line 215, in forward
    input = module(input)
  File "/Users/hugo/Desktop/Projects/conditionned_theatre_play_generation/.env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/hugo/Desktop/Projects/conditionned_theatre_play_generation/.env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/hugo/Desktop/Projects/conditionned_theatre_play_generation/model_V2.py", line 133, in forward
    out = self.ln1(x)
  File "/Users/hugo/Desktop/Projects/conditionned_theatre_play_generation/.env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/hugo/Desktop/Projects/conditionned_theatre_play_generation/.env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/hugo/Desktop/Projects/conditionned_theatre_play_generation/.env/lib/python3.8/site-packages/torch/nn/modules/normalization.py", line 196, in forward
    return F.layer_norm(
  File "/Users/hugo/Desktop/Projects/conditionned_theatre_play_generation/.env/lib/python3.8/site-packages/torch/nn/functional.py", line 2543, in layer_norm
    return torch.layer_norm(input, normalized_shape, weight, bias, eps, torch.backends.cudnn.enabled)
KeyboardInterrupt